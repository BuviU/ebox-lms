jQuery(function (e) {
  var r = "",
    l = !1,
    a = 0,
    s = 0,
    d = "",
    t =
      "ontouchstart" in window ||
      (window.DocumentTouch && document instanceof DocumentTouch)
        ? "touchstart"
        : "hover";
  if (
    (jQuery("#ebox_builder_box_wrap").length &&
      (jQuery("#ebox_builder_box_wrap").data("ld-course-id"),
      (r = jQuery("#ebox_builder_box_wrap").data("ld-typenow"))),
    jQuery("#ebox_builder_box_wrap .ebox_selectors").length)
  ) {
    if (
      (jQuery(
        "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container"
      ).each(function (e, r) {
        0 == e
          ? jQuery(".ebox-selector-post-listing", r).slideDown(
              "slow",
              function () {
                jQuery(
                  ".ebox-selector-header .ld-course-builder-action-show-hide",
                  r
                ).removeClass("ld-course-builder-action-show"),
                  jQuery(
                    ".ebox-selector-header .ld-course-builder-action-show-hide",
                    r
                  ).addClass("ld-course-builder-action-hide");
              }
            )
          : (jQuery(".ebox-selector-post-listing", r).hide(),
            jQuery(
              ".ebox-selector-header .ld-course-builder-action-show-hide",
              r
            ).addClass("ld-course-builder-action-show"),
            jQuery(
              ".ebox-selector-header .ld-course-builder-action-show-hide",
              r
            ).removeClass("ld-course-builder-action-hide"));
        var l = jQuery(r).data("ld-type");
        void 0 !== l && (v(l), w(l));
      }),
      jQuery("#ebox_builder_box_wrap .ebox_selectors").on(
        "click",
        ".ld-course-builder-action-show-hide",
        function (e, r) {
          e.stopImmediatePropagation();
          var l = jQuery(e.currentTarget).parents("h3"),
            a = jQuery(l).parent(),
            s = jQuery(a).find(".ebox-selector-post-listing");
          (void 0 === r || ("open" != r && "close" != r)) &&
            (r = jQuery(s).is(":visible") ? "close" : "open");
          "open" == r
            ? jQuery(s).slideDown("slow", function () {
                jQuery(e.currentTarget).removeClass(
                  "ld-course-builder-action-show"
                ),
                  jQuery(e.currentTarget).addClass(
                    "ld-course-builder-action-hide"
                  );
              })
            : jQuery(s).slideUp("slow", function () {
                jQuery(e.currentTarget).addClass(
                  "ld-course-builder-action-show"
                ),
                  jQuery(e.currentTarget).removeClass(
                    "ld-course-builder-action-hide"
                  );
              });
        }
      ),
      jQuery("#ebox_builder_box_wrap .ebox_selectors").on(
        "click",
        "li",
        function (e) {
          !(function (e) {
            if ("" !== e) {
              var r = jQuery(e).closest(".ebox-selector-container");
              if (void 0 !== r) jQuery(r).data("ld-type");
            }
          })(e.currentTarget);
          jQuery(e.currentTarget).hasClass("ld-disabled") ||
          jQuery(e.currentTarget).hasClass("ld-selected")
            ? jQuery(e.currentTarget).removeClass("ld-selected")
            : jQuery(e.currentTarget).addClass("ld-selected");
        }
      ),
      jQuery("#ebox_builder_box_wrap").on(
        "click",
        ".ebox_selectors .pager-info button",
        function (e) {
          e.stopImmediatePropagation();
          var r = jQuery(e.currentTarget).parents(
            ".ebox-selector-container"
          );
          if (void 0 !== r) {
            var l = jQuery(r).data("ld-type");
            if (void 0 !== l) {
              var a = jQuery(e.currentTarget).data("page");
              void 0 === l && (a = 1),
                (function (e, r, l) {
                  var a = {
                    action: "ebox_builder_selector_pager",
                    builder_data: x(),
                    builder_query_args: { post_type: r, paged: e },
                  };
                  jQuery.ajax({
                    type: "POST",
                    url: ajaxurl,
                    dataType: "json",
                    cache: !1,
                    data: a,
                    error: function (e, r, l) {},
                    success: function (e) {
                      void 0 !== e &&
                        (void 0 !== e.selector_pager &&
                          jQuery(".pager-info", l).html(e.selector_pager),
                        void 0 !== e.selector_rows &&
                          (jQuery("ul.ebox-selector-post-listing", l).html(
                            e.selector_rows
                          ),
                          jQuery(
                            "ul.ebox-selector-post-listing li",
                            l
                          ).draggable(h[r]),
                          v(r)));
                    },
                  });
                })(a, l, r);
            }
          }
          return !1;
        }
      ),
      jQuery(
        "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-search input"
      ).length)
    ) {
      var i,
        u = null,
        o = "",
        n = null;
      jQuery(
        "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-search input"
      ).on("focus", function (e) {
        var r = jQuery(e.currentTarget).parents(
          ".ebox-selector-container"
        );
        void 0 !== r &&
          void 0 !== jQuery(r).data("ld-type") &&
          ((u = jQuery(this)),
          (n = u.width()),
          console.log("search_width[%o]", n),
          jQuery(".ebox-selector-pager", r).hide(),
          jQuery(".ebox-selector-search", r).width("100%"),
          (i = setInterval(function () {
            var e = u.val();
            ((0 == e.length && o != e) || (e.length >= 3 && o != e)) &&
              c(r, (o = e)),
              u.is(":focus") ||
                (clearInterval(i),
                jQuery(".ebox-selector-pager", r).show(),
                jQuery(".ebox-selector-search", r).width(n + "px"));
          }, 250)));
      });
    }
  }
  function c(e, r) {
    if (void 0 !== e && void 0 !== r) {
      var l = jQuery(e).data("ld-type");
      if (void 0 !== l) {
        var a = {
          action: "ebox_builder_selector_search",
          builder_data: x(),
          builder_query_args: { post_type: l, paged: 1, s: r },
        };
        jQuery.ajax({
          type: "POST",
          url: ajaxurl,
          dataType: "json",
          cache: !1,
          data: a,
          error: function (e, r, l) {},
          success: function (r) {
            void 0 !== r &&
              void 0 !== r.selector_rows &&
              (jQuery("ul.ebox-selector-post-listing", e).html(
                r.selector_rows
              ),
              jQuery("ul.ebox-selector-post-listing li", e).draggable(
                h[l]
              ),
              v(l));
          },
        });
      }
    }
  }
  var h = [];
  function b(r) {
    var l = e("<div/>").attr("id", "ld-selector-draggable-team");
    if (void 0 !== r && r.length) {
      var a = 0;
      jQuery(r).each(function (e, r) {
        jQuery(".ld-course-builder-sub-actions", r).hide();
        var l = jQuery(r).outerWidth();
        l > a && (a = l);
      }),
        l.css("list-style", "none"),
        l.css("width", a + "px"),
        l.append(r.clone());
    }
    return l;
  }
  (h["ebox-modules"] = {
    cancel: ".ld-disabled",
    handle: ".ld-course-builder-action-lesson-move",
    connectToSortable:
      "#ebox_builder_box_wrap .ld-course-builder-lesson-items",
    helper: function () {
      var r = jQuery(
        "#ebox-selector-post-listing-ebox-modules li.ld-selected"
      );
      return 0 === r.length && (r = e(this)), b(r);
    },
  }),
    (h["ebox-topic"] = {
      cancel: ".ld-disabled",
      handle: ".ld-course-builder-action-topic-move",
      connectToSortable:
        "#ebox_builder_box_wrap .ld-course-builder-topic-items",
      helper: function () {
        var r = jQuery(
          "#ebox-selector-post-listing-ebox-topic li.ld-selected"
        );
        return 0 === r.length && (r = e(this)), b(r);
      },
    }),
    (h["ebox-quiz"] = {
      cancel: ".ld-disabled",
      handle: ".ld-course-builder-action-quiz-move",
      connectToSortable:
        "#ebox_builder_box_wrap .ld-course-builder-quiz-items",
      helper: function () {
        var r = jQuery(
          "#ebox-selector-post-listing-ebox-quiz li.ld-selected"
        );
        return 0 === r.length && (r = e(this)), b(r);
      },
    }),
    (h["ebox-question"] = {
      cancel: ".ld-disabled",
      handle: ".ld-course-builder-action-question-move",
      connectToSortable:
        "#ebox_builder_box_wrap .ld-course-builder-question-items",
      helper: function () {
        var r = jQuery(
          "#ebox-selector-post-listing-ebox-question li.ld-selected"
        );
        return 0 === r.length && (r = e(this)), b(r);
      },
    });
  var _ = [];
  function p() {
    (l = !0), (a = 0), (s = 0);
    var e = (function () {
      var e = new Object();
      if (
        jQuery(
          "#ebox_builder_box_wrap .ebox_builder_items .ld-course-builder-lesson-items"
        ).length
      ) {
        jQuery(
          "#ebox_builder_box_wrap .ebox_builder_items .ld-course-builder-lesson-items"
        )
          .children()
          .each(function (r, l) {
            var s = jQuery(l).data("ld-id");
            (a += 1),
              (e["ebox-modules:" + s.toString()] = {}),
              jQuery(".ld-course-builder-lesson-topic-items", l)
                .children()
                .each(function (r, l) {
                  var d = jQuery(l).data("ld-id");
                  (a += 1),
                    (e["ebox-modules:" + s.toString()][
                      "ebox-topic:" + d.toString()
                    ] = {}),
                    jQuery(".ld-course-builder-topic-quiz-items", l)
                      .children()
                      .each(function (r, l) {
                        var a = jQuery(l).data("ld-id");
                        e["ebox-modules:" + s.toString()][
                          "ebox-topic:" + d.toString()
                        ]["ebox-quiz:" + a.toString()] = {};
                      });
                }),
              jQuery(".ld-course-builder-lesson-quiz-items", l)
                .children()
                .each(function (r, l) {
                  var a = jQuery(l).data("ld-id");
                  e["ebox-modules:" + s.toString()][
                    "ebox-quiz:" + a.toString()
                  ] = {};
                });
          });
        var r = !1;
        jQuery(
          "#ebox_builder_box_wrap .ebox_builder_items .ld-course-builder-course-quiz-items"
        )
          .children()
          .each(function (l, a) {
            var s = jQuery(a).data("ld-id");
            (r = !0), (e["ebox-quiz:" + s.toString()] = {});
          }),
          1 == r && (a += 1);
      } else
        jQuery(
          "#ebox_builder_box_wrap .ebox_builder_items .ld-course-builder-question-items"
        ).length &&
          jQuery(
            "#ebox_builder_box_wrap .ebox_builder_items .ld-course-builder-question-items"
          )
            .children()
            .each(function (r, l) {
              var d = jQuery(l).data("ld-id"),
                t = jQuery(".ld-course-builder-points", l).data("ld-points");
              (s = parseInt(s) + parseInt(t)),
                (a += 1),
                (e["ebox-question:" + d.toString()] = {});
            });
      return e;
    })();
    jQuery(
      "#ebox_builder_box_wrap .ebox_builder_items .ebox_builder_items_total .ebox_builder_items_total_value"
    ).html(a),
      jQuery(
        "#ebox_builder_box_wrap .ebox_builder_items .ebox_builder_points_total_value"
      ).html(s);
    var d = JSON.stringify(e);
    ("ebox-courses" == r || "ebox-quiz" == r) &&
      jQuery("#ebox_builder_box_wrap input#ebox_builder_data").val(d);
  }
  (_["ebox-modules"] = {
    items: "> div.ld-course-builder-lesson-item",
    handle: ".ld-course-builder-action-lesson-move",
    tolerance: "pointer",
    opacity: 0.7,
    revert: 300,
    delay: 150,
    dropOnEmpty: !0,
    placeholder: "movable-placeholder",
    start: function (e, r) {
      r.placeholder.height(r.helper.outerHeight()),
        jQuery("li", r.helper).css("clear", "both"),
        jQuery("span.ld-course-builder-sub-actions", r.helper).hide();
    },
    stop: function (e, r) {
      if ("ld-selector-draggable-team" == jQuery(r.item).attr("id")) {
        var l = "",
          a = jQuery(
            "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container-ebox-modules"
          ).data("ld-selected");
        void 0 === a && (a = []),
          r.item.children("li").each(function () {
            var e,
              r,
              s,
              d = this,
              t = jQuery(d).data("ld-id");
            a.push(parseInt(t)),
              jQuery("span.ld-course-builder-sub-actions", d).hide(),
              (l =
                l +
                '<div id="ld-course-builder-lesson-item-' +
                t +
                '" class="ld-course-builder-item ld-course-builder-lesson-item" data-ld-type="ebox-modules" data-ld-id="' +
                t +
                '">' +
                jQuery(d).html() +
                "</div>"),
              void 0 !== t &&
                (f("ebox-modules", t, !0),
                (r = t),
                (s = !1),
                ("" === (e = "ebox-modules") && "" === r) ||
                  (!0 === s
                    ? jQuery(
                        "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container-" +
                          e +
                          ' ul.ebox-selector-post-listing li[data-ld-id="' +
                          r +
                          '"]'
                      ).addClass("ld-selected")
                    : jQuery(
                        "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container-" +
                          e +
                          ' ul.ebox-selector-post-listing li[data-ld-id="' +
                          r +
                          '"]'
                      ).removeClass("ld-selected")));
          }),
          jQuery(r.item).replaceWith(l),
          jQuery(
            "#ebox_builder_box_wrap .ld-course-builder-topic-items"
          ).sortable(_["ebox-topic"]),
          jQuery(
            "#ebox_builder_box_wrap .ld-course-builder-quiz-items"
          ).sortable(_["ebox-quiz"]),
          (a = jQuery.unique(a)),
          jQuery(
            "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container-ebox-modules"
          ).data("ld-selected", a),
          p();
      } else jQuery("span.ld-course-builder-sub-actions", r.item).hide(), p();
    },
  }),
    (_["ebox-topic"] = {
      items: "> div.ld-course-builder-topic-item",
      handle: ".ld-course-builder-action-topic-move",
      connectWith: ".ld-course-builder-topic-items",
      placeholder: "movable-placeholder",
      tolerance: "pointer",
      opacity: 0.7,
      revert: 300,
      delay: 150,
      dropOnEmpty: !0,
      start: function (e, r) {
        r.placeholder.height(r.helper.outerHeight()),
          r.placeholder.width("100%"),
          jQuery("span.ld-course-builder-sub-actions", r.helper).hide();
      },
      stop: function (e, r) {
        if ("ld-selector-draggable-team" == jQuery(r.item).attr("id")) {
          var l = "",
            a = jQuery(
              "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container-ebox-topic"
            ).data("ld-selected");
          void 0 === a && (a = []),
            r.item.children("li").each(function () {
              var e = this,
                r = jQuery(e).data("ld-id");
              a.push(parseInt(r)),
                jQuery("span.ld-course-builder-sub-actions", e).hide(),
                (l =
                  l +
                  '<div id="ld-course-builder-topic-item-' +
                  r +
                  '" class="ld-course-builder-item ld-course-builder-topic-item" data-ld-type="ebox-topic" data-ld-id="' +
                  r +
                  '">' +
                  jQuery(e).html() +
                  "</div>"),
                void 0 !== r &&
                  (f("ebox-topic", r, !0),
                  jQuery(
                    "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container-ebox-topic li#ld-post-" +
                      r
                  ).removeClass("ld-selected"));
            }),
            jQuery(r.item).replaceWith(l),
            jQuery(
              "#ebox_builder_box_wrap .ld-course-builder-quiz-items"
            ).sortable(_["ebox-quiz"]),
            (a = jQuery.unique(a)),
            jQuery(
              "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container-ebox-topic"
            ).data("ld-selected", a),
            p();
        } else
          jQuery(r.item).addClass("ld-course-builder-item-update"),
            jQuery("span.ld-course-builder-sub-actions", r.item).hide(),
            p();
      },
    }),
    (_["ebox-quiz"] = {
      items: "> div.ld-course-builder-quiz-item",
      handle: ".ld-course-builder-action-quiz-move",
      connectWith: ".ld-course-builder-quiz-items",
      placeholder: "movable-placeholder",
      tolerance: "pointer",
      opacity: 0.7,
      revert: 300,
      delay: 150,
      dropOnEmpty: !0,
      start: function (e, r) {
        r.placeholder.height(r.helper.outerHeight()),
          r.placeholder.width("100%"),
          jQuery("span.ld-course-builder-sub-actions", r.helper).hide();
      },
      stop: function (e, r) {
        var l = jQuery(r.item).attr("id");
        if ("ld-selector-draggable-team" == l) {
          var a = "",
            s = jQuery(
              "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container-ebox-quiz"
            ).data("ld-selected");
          void 0 === s && (s = []),
            r.item.children("li").each(function () {
              var e = this,
                r = jQuery(e).data("ld-id");
              s.push(parseInt(r)),
                jQuery("span.ld-course-builder-sub-actions", e).hide(),
                (a =
                  a +
                  '<div id="ld-course-builder-quiz-item-' +
                  r +
                  '" class="ld-course-builder-item ld-course-builder-quiz-item" data-ld-type="ebox-quiz" data-ld-id="' +
                  r +
                  '">' +
                  jQuery(e).html() +
                  "</div>"),
                void 0 !== r &&
                  (f("ebox-quiz", r, !0),
                  jQuery(
                    "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container-ebox-quiz li#ld-post-" +
                      r
                  ).removeClass("ld-selected"));
            }),
            jQuery(r.item).replaceWith(a),
            (s = jQuery.unique(s)),
            jQuery(
              "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container-ebox-quiz"
            ).data("ld-selected", s),
            p();
        } else
          "ld-draggable-builder-team" == l
            ? r.item.children("div").each(function () {
                jQuery(this).removeClass("ld-selected");
              })
            : (jQuery(r.item).addClass("ld-course-builder-item-update"),
              jQuery("span.ld-course-builder-sub-actions", r.item).hide(),
              p());
      },
    }),
    (_["ebox-question"] = {
      items: "> div.ld-course-builder-question-item",
      handle: ".ld-course-builder-action-question-move",
      connectWith: ".ld-course-builder-question-items",
      placeholder: "movable-placeholder",
      tolerance: "pointer",
      opacity: 0.7,
      revert: 300,
      delay: 150,
      dropOnEmpty: !0,
      start: function (e, r) {
        r.placeholder.height(r.helper.outerHeight()),
          r.placeholder.width("100%"),
          jQuery("span.ld-course-builder-sub-actions", r.helper).hide();
      },
      stop: function (e, r) {
        var l = jQuery(r.item).attr("id");
        if ("ld-selector-draggable-team" == l) {
          var a = "",
            s = jQuery(
              "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container-ebox-question"
            ).data("ld-selected");
          void 0 === s && (s = []),
            r.item.children("li").each(function () {
              var e = this,
                r = jQuery(e).data("ld-id");
              s.push(parseInt(r)),
                jQuery("span.ld-course-builder-sub-actions", e).hide(),
                (a =
                  a +
                  '<div id="ld-course-builder-question-item-' +
                  r +
                  '" class="ld-course-builder-item ld-course-builder-question-item" data-ld-type="ebox-question" data-ld-id="' +
                  r +
                  '">' +
                  jQuery(e).html() +
                  "</div>"),
                void 0 !== r &&
                  (f("ebox-question", r, !0),
                  jQuery(
                    "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container-ebox-question li#ld-post-" +
                      r
                  ).removeClass("ld-selected"));
            }),
            jQuery(r.item).replaceWith(a),
            (s = jQuery.unique(s)),
            jQuery(
              "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container-ebox-question"
            ).data("ld-selected", s),
            p();
        } else
          "ld-draggable-builder-team" == l
            ? r.item.children("div").each(function () {
                jQuery(this).removeClass("ld-selected");
              })
            : (jQuery(r.item).addClass("ld-course-builder-item-update"),
              jQuery("span.ld-course-builder-sub-actions", r.item).hide(),
              p());
      },
    }),
    jQuery(
      "#ebox_builder_box_wrap .ebox_selectors ul#ebox-selector-post-listing-ebox-modules li"
    ).draggable(h["ebox-modules"]),
    jQuery(
      "#ebox_builder_box_wrap .ebox_builder_items .ld-course-builder-lesson-items"
    ).sortable(_["ebox-modules"]),
    jQuery(
      "#ebox_builder_box_wrap .ebox_selectors ul#ebox-selector-post-listing-ebox-topic li"
    ).draggable(h["ebox-topic"]),
    jQuery(
      "#ebox_builder_box_wrap .ld-course-builder-topic-items"
    ).sortable(_["ebox-topic"]),
    jQuery(
      "#ebox_builder_box_wrap .ebox_selectors ul#ebox-selector-post-listing-ebox-quiz li"
    ).draggable(h["ebox-quiz"]),
    jQuery(
      "#ebox_builder_box_wrap .ld-course-builder-quiz-items"
    ).sortable(_["ebox-quiz"]),
    jQuery(
      "#ebox_builder_box_wrap .ebox_selectors ul#ebox-selector-post-listing-ebox-question li"
    ).draggable(h["ebox-question"]),
    jQuery(
      "#ebox_builder_box_wrap .ld-course-builder-question-items"
    ).sortable(_["ebox-question"]),
    jQuery("#ebox_builder_box_wrap .ebox_builder_items").on(
      "click",
      ".ld-course-builder-action-show-hide",
      function (e, r) {
        e.stopImmediatePropagation();
        var l = jQuery(e.currentTarget)
            .parents(".ld-course-builder-item")
            .first(),
          a = jQuery(l).find(".ld-course-builder-sub-items").first();
        (void 0 === r || ("open" != r && "close" != r)) &&
          (r = jQuery(a).is(":visible") ? "close" : "open");
        "open" == r
          ? jQuery(a).slideDown("slow", function () {
              jQuery(e.currentTarget).removeClass(
                "ld-course-builder-action-show"
              ),
                jQuery(e.currentTarget).addClass(
                  "ld-course-builder-action-hide"
                );
            })
          : jQuery(a).slideUp("slow", function () {
              jQuery(e.currentTarget).addClass("ld-course-builder-action-show"),
                jQuery(e.currentTarget).removeClass(
                  "ld-course-builder-action-hide"
                );
            });
      }
    ),
    jQuery("#ebox_builder_box_wrap .ebox_builder_items").on(
      "click",
      ".ld-course-builder-action-remove",
      function (e) {
        var r = jQuery(e.currentTarget).closest(".ld-course-builder-item");
        if (void 0 === r || "" === r) return;
        var l = jQuery(r).attr("data-ld-id"),
          a = jQuery(r).attr("data-ld-type"),
          s = g("confirm_remove_" + a);
        "" === s && (s = "Confirm delete");
        var d = jQuery("span.ld-course-builder-title-text", r).html();
        "" !== d && (s += "\r\n\r\n" + d);
        if (confirm(s)) {
          var t = jQuery(r).find(".ld-course-builder-item");
          void 0 !== t &&
            jQuery(t).each(function (e, r) {
              var l = jQuery(r).attr("data-ld-type"),
                a = jQuery(r).attr("data-ld-id");
              void 0 !== l && void 0 !== a && f(l, a, !1);
            }),
            f(a, l, !1),
            jQuery(r).remove(),
            p();
        }
      }
    ),
    jQuery("#ebox_builder_box_wrap .ebox_selectors").on(
      "click",
      ".ld-course-builder-action-trash",
      function (e) {
        var r = jQuery(e.currentTarget).closest("li");
        if (void 0 === r || "" === r) return;
        var l = jQuery(r).attr("data-ld-id"),
          a = jQuery(r).attr("data-ld-type"),
          s = g("confirm_trash_" + a);
        "" === s && (s = "Confirm delete");
        var d = jQuery("span.ld-course-builder-title-text", r).html();
        "" !== d && (s += "\r\n\r\n" + d);
        if (confirm(s)) {
          jQuery(r).remove(), w(a);
          var t = {
            action: "ebox_builder_selector_step_trash",
            builder_data: x(),
            builder_query_args: { post_id: l, post_type: a },
          };
          jQuery.ajax({
            type: "POST",
            url: ajaxurl,
            dataType: "json",
            cache: !1,
            data: t,
            error: function (e, r, l) {},
            success: function (e) {
              void 0 !== e && e.status;
            },
          });
        }
      }
    ),
    (window.onbeforeunload = function () {
      if (
        void 0 !== ebox_builder_assets[r].post_data.builder_editor &&
        "classic" === ebox_builder_assets[r].post_data.builder_editor &&
        !0 === l
      ) {
        var e = g("ebox_unload_message");
        if (void 0 !== e && "" !== e) return e;
      }
    });
  var y = jQuery("#ebox_builder_box_wrap").parents("form");
  function j(e) {
    e.stopImmediatePropagation();
    var r = jQuery(e.currentTarget),
      l = jQuery(".ld-course-builder-sub-actions", r);
    if (
      void 0 !== l &&
      void 0 === jQuery(r).closest("div#ld-selector-draggable-team").attr("id")
    )
      if (jQuery(l).is(":visible")) "touchstart" == t && jQuery(l).hide();
      else {
        "touchstart" == t &&
          jQuery(
            "#ebox_builder_box_wrap .ld-course-builder-sub-actions"
          ).hide();
        var a = jQuery(r).position(),
          s = jQuery(r).outerWidth(),
          d = jQuery(l).outerWidth();
        if (jQuery("body").hasClass("rtl")) var i = a.left - d + 5 + "px";
        else i = a.left + s + "px";
        jQuery(l)
          .css({
            "background-color": "#B8B8B8",
            height: "20px",
            position: "absolute",
            top: a.top + "px",
            left: i,
          })
          .show();
      }
  }
  function Q(e) {
    var r = jQuery(e.currentTarget),
      l = jQuery(".ld-course-builder-sub-actions", r);
    void 0 !== l && jQuery(l).hide();
  }
  function v(e, r) {
    if ("" !== e) {
      var l = jQuery(
        '#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container[data-ld-type="' +
          e +
          '"]'
      );
      if (void 0 !== l) {
        var a = jQuery(l).data("ld-selected");
        void 0 !== a &&
          a.length &&
          jQuery.each(a, function (r, l) {
            f(e, l, !0);
          });
      }
    }
  }
  function w(e) {
    if ("" !== e) {
      var r = jQuery(
        '#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container[data-ld-type="' +
          e +
          '"]'
      );
      jQuery("ul#ebox-selector-post-listing-" + e + " li", r).length
        ? (jQuery(".ebox-selector-pager", r).show(),
          jQuery(".ebox-selector-search", r).show())
        : (jQuery(".ebox-selector-pager", r).hide(),
          jQuery(".ebox-selector-search", r).hide());
    }
  }
  function f(e, r, l) {
    if ("" !== e && "" !== r) {
      var a = jQuery(
        "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container-" +
          e
      ).data("ld-selected");
      void 0 === a && (a = []);
      var s = !1;
      !0 === l
        ? (jQuery(
            "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container-" +
              e +
              ' ul.ebox-selector-post-listing li[data-ld-id="' +
              r +
              '"]'
          ).addClass("ld-disabled"),
          -1 === a.indexOf(parseInt(r)) && (a.push(parseInt(r)), (s = !0)))
        : (jQuery(
            "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container-" +
              e +
              ' ul.ebox-selector-post-listing li[data-ld-id="' +
              r +
              '"]'
          ).removeClass("ld-disabled"),
          (a = a.filter(function (e) {
            return e !== parseInt(r);
          })),
          (s = !0)),
        1 == s &&
          jQuery(
            "#ebox_builder_box_wrap .ebox_selectors .ebox-selector-container-" +
              e
          ).data("ld-selected", a);
    }
  }
  function m() {
    if ("" == d && jQuery("#ebox_builder_box_wrap .ld-new-step").length) {
      var e = {};
      if (
        (jQuery("#ebox_builder_box_wrap .ld-new-step").each(function (
          r,
          l
        ) {
          var a = {};
          (a.item_id = jQuery(l).attr("id")),
            (a.post_type = jQuery(l).data("ld-type")),
            jQuery('input[type="text"]', l).length
              ? (a.post_title = jQuery('input[type="text"]', l).val())
              : (a.post_title = jQuery(
                  ".ld-course-builder-title-text",
                  l
                ).val()),
            (e[a.item_id] = a);
        }),
        Object.keys(e).length > 0)
      ) {
        var r = {
          action: "ebox_builder_selector_step_new",
          builder_data: x(),
          builder_query_args: { new_steps: e },
        };
        d = jQuery.ajax({
          type: "POST",
          url: ajaxurl,
          dataType: "json",
          cache: !1,
          data: r,
          error: function (e, r, l) {},
          success: function (e) {
            void 0 !== e &&
              void 0 !== e.new_steps &&
              jQuery.each(e.new_steps, function (e, r) {
                jQuery("#ebox_builder_box_wrap #" + e).length &&
                  jQuery("#ebox_builder_box_wrap #" + e).hasClass(
                    "ld-new-step"
                  ) &&
                  (jQuery("#ebox_builder_box_wrap #" + e).removeClass(
                    "ld-new-step"
                  ),
                  jQuery("#ebox_builder_box_wrap #" + e).attr(
                    "data-ld-id",
                    r.post_id
                  ),
                  jQuery(
                    "#ebox_builder_box_wrap #" +
                      e +
                      " a.ld-course-builder-action-view"
                  ).attr("href", r.view_url.replace(/&amp;/g, "&")),
                  jQuery(
                    "#ebox_builder_box_wrap #" +
                      e +
                      " a.ld-course-builder-action-edit"
                  ).attr("href", r.edit_url.replace(/&amp;/g, "&")),
                  jQuery("#ebox_builder_box_wrap #" + e).attr(
                    "id",
                    "ld-post-" + r.post_id
                  ));
              }),
              (d = ""),
              m();
          },
        });
      }
    }
  }
  function g(e) {
    if (void 0 !== ebox_builder_assets[r].messages)
      return void 0 !== e && void 0 !== ebox_builder_assets[r].messages[e]
        ? ebox_builder_assets[r].messages[e]
        : ebox_builder_assets[r].messages;
  }
  function x(e) {
    if (void 0 !== ebox_builder_assets[r].post_data)
      return void 0 !== e && void 0 !== ebox_builder_assets[r].post_data[e]
        ? ebox_builder_assets[r].post_data[e]
        : ebox_builder_assets[r].post_data;
  }
  void 0 !== y &&
    jQuery(y).on("submit", function () {
      l = !1;
    }),
    "hover" == t
      ? (jQuery("#ebox_builder_box_wrap .ebox_builder_items").on(
          "mouseover",
          ".ld-course-builder-actions",
          j
        ),
        jQuery("#ebox_builder_box_wrap .ebox_builder_items").on(
          "mouseleave",
          ".ld-course-builder-actions",
          Q
        ),
        jQuery("#ebox_builder_box_wrap .ebox_selectors").on(
          "mouseover",
          ".ld-course-builder-actions",
          j
        ),
        jQuery("#ebox_builder_box_wrap .ebox_selectors").on(
          "mouseleave",
          ".ld-course-builder-actions",
          Q
        ))
      : "touchstart" == t &&
        (jQuery("#ebox_builder_box_wrap .ebox_builder_items").on(
          "click",
          ".ld-course-builder-actions",
          j
        ),
        jQuery("#ebox_builder_box_wrap .ebox_selectors").on(
          "click",
          ".ld-course-builder-actions",
          j
        )),
    jQuery("#ebox_builder_box_wrap").on(
      "mouseover",
      ".ld-course-builder-title",
      function (e) {
        e.stopImmediatePropagation();
        var r = !0,
          l = jQuery(e.currentTarget).closest(".ld-course-builder-item")[0];
        void 0 !== l &&
          (jQuery(l).hasClass("ld-disabled") && (r = !1),
          jQuery(l).hasClass("ld-course-builder-title-edit") && (r = !1),
          1 == r &&
            jQuery(
              ".ld-course-builder-edit-title-pencil",
              e.currentTarget
            ).show());
      }
    ),
    jQuery("#ebox_builder_box_wrap").on(
      "mouseleave",
      ".ld-course-builder-title",
      function (e) {
        e.stopImmediatePropagation(),
          jQuery(
            ".ld-course-builder-edit-title-pencil",
            e.currentTarget
          ).hide();
      }
    ),
    jQuery("#ebox_builder_box_wrap").on(
      "click",
      ".ld-course-builder-title",
      function (e) {
        e.stopImmediatePropagation();
        var r = e.currentTarget,
          l = jQuery(r).parents(".ld-course-builder-item");
        if (void 0 !== l) {
          if (jQuery(l).hasClass("ld-disabled")) return;
          if (jQuery(l).hasClass("ld-course-builder-title-edit")) return;
          jQuery(l).addClass("ld-course-builder-title-edit"),
            jQuery(l).hasClass("ld-selected") &&
              jQuery(l).removeClass("ld-selected"),
            jQuery(".ld-course-builder-actions", l).hide();
          var a = jQuery(".ld-course-builder-title-text", r).html();
          function s(e) {
            e.stopImmediatePropagation();
            var l = jQuery(e.currentTarget).parents(".ld-course-builder-item");
            jQuery(l).removeClass("ld-course-builder-title-edit");
            var s = jQuery(".ld-course-builder-title-text input", r).val();
            if (
              (jQuery(".ld-course-builder-title-text input", r).remove(),
              jQuery(".ld-course-builder-edit-title-ok", r).hide(),
              jQuery(".ld-course-builder-edit-title-cancel", r).hide(),
              jQuery(".ld-course-builder-actions", l).show(),
              "" != s && s != a)
            ) {
              if (
                (jQuery(".ld-course-builder-title-text", r).html(s),
                (a = s),
                void 0 !== (l = jQuery(r).parents(".ld-course-builder-item")))
              ) {
                var d = jQuery(l).data("ld-id"),
                  t = jQuery(l).data("ld-type"),
                  i = {
                    action: "ebox_builder_selector_step_title",
                    builder_data: x(),
                    builder_query_args: {
                      new_title: s,
                      post_id: d,
                      post_type: t,
                    },
                  };
                console.log("post_data[%o]", i),
                  jQuery.ajax({
                    type: "POST",
                    url: ajaxurl,
                    dataType: "json",
                    cache: !1,
                    data: i,
                    error: function (e, r, l) {},
                    success: function (e) {
                      if (void 0 !== e.status && !0 === e.status) {
                        var r = jQuery(
                          "#ebox_builder_box_wrap .ebox_selectors li#ld-post-" +
                            d
                        );
                        jQuery(".ld-course-builder-title-text", r).html(s);
                        var l = jQuery(
                          "#ebox_builder_box_wrap .ebox_builder_items #ld-post-" +
                            d
                        );
                        jQuery(".ld-course-builder-title-text", l)
                          .first()
                          .html(s);
                      }
                    },
                  });
              }
            } else jQuery(".ld-course-builder-title-text", r).html(a);
          }
          jQuery(".ld-course-builder-title-text", r).html(
            '<input type="text" value="' + a + '" />'
          ),
            jQuery(".ld-course-builder-title-text input", r).focus(),
            jQuery(".ld-course-builder-title-text input", r).select(),
            jQuery(".ld-course-builder-edit-title-pencil", r).hide(),
            jQuery(".ld-course-builder-edit-title-ok", r).show(),
            jQuery(".ld-course-builder-edit-title-cancel", r).show(),
            jQuery(r).on(
              "click",
              ".ld-course-builder-edit-title-ok",
              function (e) {
                s(e);
              }
            ),
            jQuery(r).on("keypress", ":focus", function (e) {
              13 == e.keyCode && s(e);
            }),
            jQuery(r).on(
              "click",
              ".ld-course-builder-edit-title-cancel",
              function (e) {
                e.stopImmediatePropagation();
                var l = jQuery(e.currentTarget).parents(
                  ".ld-course-builder-item"
                );
                if (
                  (jQuery(l).removeClass("ld-course-builder-title-edit"),
                  jQuery(".ld-course-builder-title-text input", r).remove(),
                  jQuery(".ld-course-builder-edit-title-ok", r).hide(),
                  jQuery(".ld-course-builder-edit-title-cancel", r).hide(),
                  jQuery(".ld-course-builder-actions", l).show(),
                  jQuery(".ld-course-builder-action-show-hide", l).length)
                ) {
                  var s = (function (e) {
                    if (void 0 !== e) {
                      var r = jQuery(e).closest(".ebox_selectors");
                      if (void 0 !== r && r.length > 0) return r[0];
                      var l = jQuery(e).closest(".ebox_builder_items");
                      if (void 0 !== l && l.length > 0) return l[0];
                    }
                  })(l);
                  void 0 !== s &&
                    jQuery(s).hasClass("ebox_builder_items") &&
                    jQuery(".ld-course-builder-action-show-hide", l).show();
                }
                jQuery(".ld-course-builder-title-text", r).html(a);
              }
            );
        }
      }
    ),
    jQuery(".ebox_selectors").on(
      "click",
      ".ld-course-builder-action-add",
      function (e) {
        if (
          (e.stopImmediatePropagation(),
          !jQuery(e.currentTarget).hasClass(
            "ld-course-builder-action-add-pending"
          ))
        ) {
          jQuery(e.currentTarget).addClass(
            "ld-course-builder-action-add-pending"
          );
          var r = jQuery(e.currentTarget).closest(
            ".ebox-selector-container"
          );
          if (void 0 !== r) {
            var l = jQuery(r).find(".ld-course-builder-action-show-hide");
            jQuery(l).hasClass("ld-course-builder-action-show") &&
              jQuery(".ld-course-builder-action-show-hide", r).trigger(
                "click",
                ["open"]
              );
            var a = jQuery(r).data("ld-type");
            if (void 0 !== a) {
              var s = "new-step-" + new Date().getTime(),
                d = jQuery(".ebox-row-placeholder li", r).clone();
              jQuery(d).attr("id", s),
                jQuery(d).attr("data-ld-id", ""),
                jQuery(d).removeClass("ld-disabled"),
                jQuery(d).removeClass("ld-selected"),
                jQuery(d).removeClass("ld-course-builder-title-edit"),
                jQuery(d).addClass("ld-new-step");
              var t = jQuery(
                ".ld-course-builder-header .ld-course-builder-title",
                d
              );
              jQuery(t).hasClass("ld-course-builder-title-edit") &&
                jQuery('input[type="text"]', t).length &&
                jQuery('input[type="text"]', t).remove(),
                jQuery(
                  "#ebox_builder_box_wrap .ebox_selectors ul#ebox-selector-post-listing-" +
                    a
                ).prepend(d),
                jQuery(
                  "#ebox_builder_box_wrap .ebox_selectors ul#ebox-selector-post-listing-" +
                    a +
                    " li"
                ).draggable(h[a]),
                jQuery(
                  "#ebox_builder_box_wrap #" +
                    s +
                    " .ld-course-builder-title-text"
                ).trigger("click"),
                w(a),
                m(),
                jQuery(e.currentTarget).removeClass(
                  "ld-course-builder-action-add-pending"
                );
            }
          }
        }
      }
    ),
    jQuery("#ebox_builder_box_wrap .ebox_selectors").on(
      "click",
      ".ld-show-all",
      function (e) {
        jQuery(
          "#ebox_builder_box_wrap .ebox_selectors h3.ebox-selector-header .ld-course-builder-action-show-hide"
        ).trigger("click", ["open"]);
      }
    ),
    jQuery("#ebox_builder_box_wrap .ebox_selectors").on(
      "click",
      ".ld-hide-all",
      function (e) {
        jQuery(
          "#ebox_builder_box_wrap .ebox_selectors h3.ebox-selector-header .ld-course-builder-action-show-hide"
        ).trigger("click", ["close"]);
      }
    ),
    jQuery("#ebox_builder_box_wrap .ebox_builder_items").on(
      "click",
      ".ld-show-all",
      function (e) {
        jQuery(
          "#ebox_builder_box_wrap .ebox_builder_items .ld-course-builder-action-show-hide"
        ).trigger("click", ["open"]);
      }
    ),
    jQuery("#ebox_builder_box_wrap .ebox_builder_items").on(
      "click",
      ".ld-hide-all",
      function (e) {
        jQuery(
          "#ebox_builder_box_wrap .ebox_builder_items .ld-course-builder-action-show-hide"
        ).trigger("click", ["close"]);
      }
    );
});
